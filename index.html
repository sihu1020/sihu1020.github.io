<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>21세기 축구선수 티어리스트 메이커</title>
    <style>
      :root {
        --bg: #0f172a;
        --panel: rgba(15, 23, 42, 0.8);
        --surface: rgba(30, 41, 59, 0.8);
        --accent: #38bdf8;
        --accent-strong: #0ea5e9;
        --text: #e2e8f0;
        --muted: #94a3b8;
        --border: rgba(148, 163, 184, 0.3);
        --danger: #f97316;
        color-scheme: dark;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Pretendard", "Noto Sans KR", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
        background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.25), transparent 55%),
          radial-gradient(circle at bottom right, rgba(14, 165, 233, 0.2), transparent 50%),
          var(--bg);
        min-height: 100vh;
        color: var(--text);
      }

      header {
        padding: clamp(1.5rem, 5vw, 3rem) clamp(1.5rem, 5vw, 4rem) 1.5rem;
      }

      header h1 {
        margin: 0 0 0.7rem;
        font-size: clamp(2rem, 4vw, 2.8rem);
        font-weight: 700;
        color: #f8fafc;
      }

      header p {
        margin: 0;
        max-width: 740px;
        font-size: 1.05rem;
        line-height: 1.6;
        color: var(--muted);
      }

      main {
        display: grid;
        grid-template-columns: minmax(260px, 360px) 1fr;
        gap: 1.5rem;
        padding: 0 clamp(1.5rem, 5vw, 4rem) clamp(2rem, 6vw, 4rem);
      }

      @media (max-width: 980px) {
        main {
          grid-template-columns: 1fr;
        }
      }

      .panel {
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 22px;
        padding: clamp(1.2rem, 3vw, 1.8rem);
        backdrop-filter: blur(16px);
        box-shadow: 0 20px 45px rgba(8, 47, 73, 0.35);
      }

      .control-panel {
        display: grid;
        gap: 1.5rem;
        align-content: start;
        position: sticky;
        top: 1.5rem;
        height: fit-content;
      }

      @media (max-width: 980px) {
        .control-panel {
          position: static;
        }
      }

      .current-position {
        display: flex;
        flex-direction: column;
        gap: 0.6rem;
      }

      .current-position h2 {
        margin: 0;
        font-size: 1.6rem;
        color: #f1f5f9;
      }

      .current-position span {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        color: var(--muted);
        font-size: 0.95rem;
      }

      .current-player-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 18px;
        padding: 1.2rem;
        display: grid;
        gap: 0.8rem;
      }

      .current-player-card h3 {
        margin: 0;
        font-size: 1.2rem;
        color: #e0f2fe;
      }

      .current-player-name {
        font-size: clamp(1.4rem, 3vw, 1.9rem);
        font-weight: 700;
        letter-spacing: 0.01em;
        color: #bae6fd;
      }

      .current-player-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        font-size: 0.92rem;
        color: var(--muted);
      }

      .button-group {
        display: flex;
        flex-wrap: wrap;
        gap: 0.6rem;
      }

      button {
        font: inherit;
        border: none;
        border-radius: 999px;
        padding: 0.65rem 1.3rem;
        cursor: pointer;
        transition: transform 0.15s ease, box-shadow 0.2s ease;
      }

      button:disabled {
        cursor: not-allowed;
        opacity: 0.6;
      }

      .primary {
        background: linear-gradient(120deg, var(--accent), var(--accent-strong));
        color: #0b1120;
        font-weight: 700;
        box-shadow: 0 12px 24px rgba(14, 165, 233, 0.3);
      }

      .primary:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 16px 34px rgba(14, 165, 233, 0.35);
      }

      .ghost {
        background: transparent;
        border: 1px solid var(--border);
        color: var(--muted);
      }

      .ghost:hover:not(:disabled) {
        border-color: rgba(148, 163, 184, 0.6);
        transform: translateY(-1px);
      }

      .status-message {
        min-height: 2.5em;
        font-size: 0.95rem;
        color: var(--muted);
      }

      .status-message strong {
        color: #f1f5f9;
      }

      .remaining-list {
        display: grid;
        gap: 0.6rem;
      }

      .remaining-list h3 {
        margin: 0;
        font-size: 1.05rem;
        color: #e2e8f0;
      }

      .remaining-list ul {
        margin: 0;
        padding: 0;
        list-style: none;
        display: grid;
        gap: 0.35rem;
        max-height: 220px;
        overflow: auto;
        border-radius: 12px;
      }

      .remaining-list li {
        padding: 0.45rem 0.75rem;
        border-radius: 12px;
        background: rgba(15, 23, 42, 0.55);
        border: 1px solid rgba(148, 163, 184, 0.22);
        font-size: 0.9rem;
        color: var(--muted);
      }

      .board-panel {
        display: grid;
        gap: 1rem;
      }

      .position-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .position-tab {
        padding: 0.45rem 0.95rem;
        border-radius: 999px;
        border: 1px solid transparent;
        background: rgba(15, 23, 42, 0.55);
        color: var(--muted);
        font-size: 0.95rem;
        cursor: pointer;
        transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
      }

      .position-tab.active {
        background: rgba(56, 189, 248, 0.18);
        color: #e0f2fe;
        border-color: rgba(56, 189, 248, 0.35);
      }

      .tier-board {
        display: grid;
        gap: 1rem;
      }

      .tier-card {
        background: var(--surface);
        border-radius: 18px;
        border: 1px solid var(--border);
        padding: 1rem 1.2rem;
        display: grid;
        gap: 0.8rem;
      }

      .tier-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 0.6rem;
        flex-wrap: wrap;
      }

      .tier-name {
        margin: 0;
        font-size: 1.25rem;
        color: #f1f5f9;
      }

      .tier-capacity {
        font-size: 0.85rem;
        color: var(--muted);
      }

      .tier-slots,
      .tier-dynamic {
        display: flex;
        flex-wrap: wrap;
        gap: 0.6rem;
      }

      .slot,
      .drop-zone {
        flex: 1 1 120px;
        min-width: 120px;
        border-radius: 14px;
        border: 1px dashed rgba(148, 163, 184, 0.45);
        padding: 0.75rem 0.9rem;
        background: rgba(15, 23, 42, 0.35);
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        align-items: flex-start;
        justify-content: center;
        cursor: pointer;
        transition: border-color 0.15s ease, transform 0.15s ease, background 0.2s ease;
      }

      .slot:hover,
      .drop-zone:hover {
        border-color: rgba(56, 189, 248, 0.55);
        background: rgba(15, 23, 42, 0.6);
      }

      .slot.filled {
        border-style: solid;
        border-color: rgba(148, 163, 184, 0.6);
        background: rgba(15, 23, 42, 0.65);
      }

      .slot.filled:hover {
        transform: translateY(-1px);
      }

      .slot-label {
        font-size: 0.78rem;
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .player-chip {
        font-size: 1rem;
        font-weight: 600;
        color: #e2e8f0;
      }

      .remove-button {
        align-self: flex-end;
        background: transparent;
        border: none;
        color: var(--danger);
        font-size: 0.8rem;
        cursor: pointer;
        padding: 0.2rem 0.4rem;
      }

      .remove-button:hover {
        color: #fb923c;
      }

      .drop-zone.dynamic {
        justify-content: center;
        align-items: center;
        color: var(--muted);
        font-size: 0.85rem;
      }

      .dynamic-player {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.6rem 0.85rem;
        border-radius: 999px;
        background: rgba(56, 189, 248, 0.14);
        color: #f1f5f9;
        border: 1px solid rgba(56, 189, 248, 0.4);
      }

      .dynamic-player button {
        border-radius: 50%;
        padding: 0.2rem 0.5rem;
        background: transparent;
        border: none;
        color: rgba(248, 250, 252, 0.7);
        cursor: pointer;
      }

      .dynamic-player button:hover {
        color: #f87171;
      }

      .empty-note {
        font-size: 0.9rem;
        color: var(--muted);
      }

      .instructions {
        font-size: 0.9rem;
        color: rgba(226, 232, 240, 0.8);
        line-height: 1.6;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>21세기 축구선수 티어리스트 메이커</h1>
      <p>
        포지션별 최고의 선수들을 티어에 배치해 보세요. "다음 선수 뽑기" 버튼을 누르면 AI가 랜덤으로
        포지션과 선수를 제안합니다. 제안된 선수는 해당 포지션의 티어 보드에서 원하는 위치를 눌러 배치할 수
        있습니다.
      </p>
    </header>
    <main>
      <section class="control-panel panel">
        <div class="current-position">
          <h2><span data-current-position>GK</span> 티어 관리</h2>
          <span>왼쪽이 더 높은 순위입니다.</span>
        </div>
        <div class="current-player-card">
          <h3>현재 제안된 선수</h3>
          <div class="current-player-name" data-current-player-name>선수를 뽑아 주세요</div>
          <div class="current-player-meta" data-current-player-meta>
            포지션과 티어를 선택해 배치할 선수를 뽑아 보세요.
          </div>
        </div>
        <div class="instructions">
          <p>
            원하는 티어의 빈 슬롯을 클릭하면 선수가 배치됩니다. 이미 채워진 칸을 눌러 교체할 수도 있고, 칸의 X
            버튼을 눌러 비울 수 있습니다.
          </p>
        </div>
        <div class="button-group">
          <button class="primary" type="button" data-action="random">다음 선수 뽑기</button>
          <button class="ghost" type="button" data-action="reset">티어 전체 초기화</button>
        </div>
        <div class="status-message" data-status></div>
        <div class="remaining-list">
          <h3>남은 후보</h3>
          <ul data-remaining></ul>
        </div>
      </section>
      <section class="board-panel">
        <div class="position-tabs" data-position-tabs></div>
        <div class="tier-board" data-tier-board></div>
      </section>
    </main>
    <script>
      const POSITIONS = [
        { key: "GK", label: "GK" },
        { key: "LB", label: "LB" },
        { key: "CB", label: "CB" },
        { key: "RB", label: "RB" },
        { key: "CDM", label: "CDM" },
        { key: "CM", label: "CM" },
        { key: "CAM", label: "CAM" },
        { key: "ST", label: "ST" },
        { key: "LW", label: "LW" },
        { key: "RW", label: "RW" }
      ];

      const TIERS = [
        { key: "heaven", label: "Heaven", limit: null, ordered: false },
        { key: "goat", label: "G.O.A.T", limit: null, ordered: false },
        { key: "legend", label: "Legend", limit: null, ordered: false },
        { key: "worldclass", label: "Worldclass", limit: null },
        { key: "good", label: "Good", limit: null },
        { key: "normal", label: "Normal", limit: null },
        { key: "notGood", label: "Not good", limit: null }
      ];

      const PLAYERS_BY_POSITION = {
        GK: [
          "Gianluigi Buffon",
          "Iker Casillas",
          "Manuel Neuer",
          "Alisson Becker",
          "Ederson",
          "Thibaut Courtois",
          "Petr Čech",
          "Hugo Lloris",
          "Jan Oblak",
          "Marc-André ter Stegen",
          "David de Gea",
          "Samir Handanović"
        ],
        LB: [
          "Paolo Maldini",
          "Ashley Cole",
          "Roberto Carlos",
          "Marcelo",
          "David Alaba",
          "Andrew Robertson",
          "Jordi Alba",
          "Theo Hernández",
          "Leighton Baines",
          "Aleksandar Kolarov"
        ],
        CB: [
          "Sergio Ramos",
          "Virgil van Dijk",
          "Carles Puyol",
          "John Terry",
          "Rio Ferdinand",
          "Thiago Silva",
          "Giorgio Chiellini",
          "Gerard Piqué",
          "Raphaël Varane",
          "Nemanja Vidić",
          "Kalidou Koulibaly",
          "Rúben Dias"
        ],
        RB: [
          "Cafu",
          "Dani Alves",
          "Philipp Lahm",
          "Trent Alexander-Arnold",
          "Kyle Walker",
          "João Cancelo",
          "Maicon",
          "Juan Cuadrado",
          "Achraf Hakimi",
          "Kieran Trippier"
        ],
        CDM: [
          "Sergio Busquets",
          "Casemiro",
          "Claude Makélélé",
          "Patrick Vieira",
          "Andrea Pirlo",
          "Michael Essien",
          "N'Golo Kanté",
          "Xabi Alonso",
          "Rodri",
          "Fernandinho"
        ],
        CM: [
          "Luka Modrić",
          "Kevin De Bruyne",
          "Xavi",
          "Steven Gerrard",
          "Frank Lampard",
          "Toni Kroos",
          "Paul Scholes",
          "Andrés Iniesta",
          "Cesc Fàbregas",
          "Bastian Schweinsteiger",
          "Yaya Touré",
          "Santi Cazorla"
        ],
        CAM: [
          "Zinedine Zidane",
          "Ronaldinho",
          "Mesut Özil",
          "Kaká",
          "Thomas Müller",
          "David Silva",
          "Bruno Fernandes",
          "Bernardo Silva",
          "James Rodríguez",
          "Juan Mata"
        ],
        ST: [
          "Lionel Messi",
          "Cristiano Ronaldo",
          "Robert Lewandowski",
          "Karim Benzema",
          "Zlatan Ibrahimović",
          "Luis Suárez",
          "Didier Drogba",
          "Erling Haaland",
          "Sergio Agüero",
          "Harry Kane",
          "Wayne Rooney",
          "Samuel Eto'o"
        ],
        LW: [
          "Neymar",
          "Ronaldinho",
          "Thierry Henry",
          "Sadio Mané",
          "Eden Hazard",
          "Son Heung-min",
          "Franck Ribéry",
          "Arjen Robben",
          "Kylian Mbappé",
          "Vinícius Júnior"
        ],
        RW: [
          "Mohamed Salah",
          "Arjen Robben",
          "Gareth Bale",
          "Riyad Mahrez",
          "Ángel Di María",
          "Sadio Mané",
          "Bukayo Saka",
          "Ousmane Dembélé",
          "Raheem Sterling",
          "Serge Gnabry"
        ]
      };

      const STORAGE_KEY = "tierlist-state-v1";

      const dom = {
        currentPosition: document.querySelector("[data-current-position]"),
        currentPlayerName: document.querySelector("[data-current-player-name]"),
        currentPlayerMeta: document.querySelector("[data-current-player-meta]"),
        status: document.querySelector("[data-status]"),
        remaining: document.querySelector("[data-remaining]"),
        tierBoard: document.querySelector("[data-tier-board]"),
        positionTabs: document.querySelector("[data-position-tabs]"),
        randomButton: document.querySelector('[data-action="random"]'),
        resetButton: document.querySelector('[data-action="reset"]')
      };

      let state = loadState();
      let currentPosition = POSITIONS[0].key;
      let currentCandidate = null;
      let statusTimeout = null;

      function loadState() {
        const base = createEmptyState();
        try {
          const raw = JSON.parse(localStorage.getItem(STORAGE_KEY) || "null");
          if (!raw || typeof raw !== "object") {
            return base;
          }
          POSITIONS.forEach(({ key: position }) => {
            const positionState = raw[position];
            TIERS.forEach((tier) => {
              if (tier.limit) {
                base[position][tier.key] = Array.from({ length: tier.limit }, (_, index) => {
                  const value = positionState?.[tier.key]?.[index];
                  return typeof value === "string" && value.trim() ? value.trim() : null;
                });
              } else {
                const value = positionState?.[tier.key];
                if (Array.isArray(value)) {
                  base[position][tier.key] = value
                    .filter((item) => typeof item === "string" && item.trim())
                    .map((item) => item.trim());
                }
              }
            });
          });
        } catch (error) {
          console.warn("상태를 불러오는 중 문제가 발생했습니다:", error);
        }
        return base;
      }

      function createEmptyState() {
        const empty = {};
        POSITIONS.forEach(({ key }) => {
          empty[key] = {};
          TIERS.forEach((tier) => {
            empty[key][tier.key] = tier.limit ? Array.from({ length: tier.limit }, () => null) : [];
          });
        });
        return empty;
      }

      function saveState() {
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        } catch (error) {
          console.warn("상태를 저장할 수 없습니다:", error);
        }
      }

      function setCurrentPosition(position) {
        currentPosition = position;
        renderPositionTabs();
        renderBoard();
        updateCurrentPositionLabel();
        updateRemainingList();
      }

      function renderPositionTabs() {
        dom.positionTabs.innerHTML = "";
        POSITIONS.forEach(({ key, label }) => {
          const button = document.createElement("button");
          button.type = "button";
          button.textContent = label;
          button.className = "position-tab" + (key === currentPosition ? " active" : "");
          if (currentCandidate && currentCandidate.position === key) {
            button.dataset.hasCandidate = "true";
          }
          button.addEventListener("click", () => {
            setCurrentPosition(key);
          });
          dom.positionTabs.appendChild(button);
        });
      }

      function renderBoard() {
        dom.tierBoard.innerHTML = "";
        TIERS.forEach((tier) => {
          const section = document.createElement("section");
          section.className = "tier-card";

          const header = document.createElement("div");
          header.className = "tier-header";

          const title = document.createElement("h3");
          title.className = "tier-name";
          title.textContent = tier.label;

          const capacity = document.createElement("span");
          capacity.className = "tier-capacity";
          capacity.textContent = tier.limit
            ? `${tier.limit}명까지 배치`
            : "인원 제한 없음";

          header.append(title, capacity);
          section.appendChild(header);

          const container = document.createElement("div");
          const ordered = tier.ordered !== false;
          if (tier.limit) {
            container.className = "tier-slots";
            const slots = state[currentPosition][tier.key];
            slots.forEach((player, index) => {
              const slot = document.createElement("div");
              slot.className = "slot" + (player ? " filled" : "");
              slot.dataset.tier = tier.key;
              slot.dataset.index = index;

              const label = document.createElement("span");
              label.className = "slot-label";
              label.textContent = `${index + 1}위`;

              slot.appendChild(label);

              if (player) {
                const name = document.createElement("span");
                name.className = "player-chip";
                name.textContent = player;
                slot.appendChild(name);

                const remove = document.createElement("button");
                remove.type = "button";
                remove.className = "remove-button";
                remove.textContent = "비우기";
                remove.addEventListener("click", (event) => {
                  event.stopPropagation();
                  state[currentPosition][tier.key][index] = null;
                  saveState();
                  renderBoard();
                  updateRemainingList();
                  showStatus(`${tier.label} 티어 ${index + 1}위를 비웠습니다.`);
                });
                slot.appendChild(remove);
              } else {
                const empty = document.createElement("span");
                empty.className = "empty-note";
                empty.textContent = "빈 슬롯";
                slot.appendChild(empty);
              }

              slot.addEventListener("click", () => {
                handleFixedSlotSelection(tier, index);
              });

              container.appendChild(slot);
            });
          } else {
            container.className = "tier-dynamic";
            const players = state[currentPosition][tier.key];
            if (!players.length) {
              const zone = createDynamicDropZone(tier, 0);
              container.appendChild(zone);
            } else {
              players.forEach((player, index) => {
                const zone = createDynamicDropZone(tier, index);
                container.appendChild(zone);

                const chip = document.createElement("div");
                chip.className = "dynamic-player";
                chip.dataset.tier = tier.key;
                chip.dataset.index = index;

                const name = document.createElement("span");
                name.textContent = ordered ? `${index + 1}. ${player}` : player;
                chip.appendChild(name);

                const remove = document.createElement("button");
                remove.type = "button";
                remove.setAttribute("aria-label", "선수 제거");
                remove.textContent = "✕";
                remove.addEventListener("click", () => {
                  state[currentPosition][tier.key].splice(index, 1);
                  saveState();
                  renderBoard();
                  updateRemainingList();
                  showStatus(`${tier.label} 티어에서 ${player} 선수를 제거했습니다.`);
                });
                chip.appendChild(remove);

                container.appendChild(chip);
              });
              const zone = createDynamicDropZone(tier, players.length);
              container.appendChild(zone);
            }
          }

          section.appendChild(container);
          dom.tierBoard.appendChild(section);
        });
      }

      function createDynamicDropZone(tier, index) {
        const button = document.createElement("button");
        button.type = "button";
        button.className = "drop-zone dynamic";
        button.dataset.tier = tier.key;
        button.dataset.index = index;
        const ordered = tier.ordered !== false;
        if (currentCandidate) {
          button.textContent = ordered ? `${index + 1}번째 자리에 배치` : "이 위치에 배치";
        } else {
          button.textContent = ordered ? `빈 슬롯 (${index + 1}번째)` : "빈 자리";
        }
        button.disabled = !currentCandidate;
        button.addEventListener("click", () => {
          handleDynamicInsertion(tier, index);
        });
        return button;
      }

      function handleFixedSlotSelection(tier, index) {
        if (!currentCandidate) {
          showStatus("먼저 선수를 뽑아 주세요.");
          return;
        }
        if (currentCandidate.position !== currentPosition) {
          setCurrentPosition(currentCandidate.position);
          showStatus("제안된 선수의 포지션 보드로 이동했습니다. 다시 시도하세요.");
          return;
        }

        removePlayerFromState(currentCandidate.position, currentCandidate.name);
        state[currentPosition][tier.key][index] = currentCandidate.name;
        saveState();
        showStatus(`${currentCandidate.name} 선수를 ${tier.label} 티어 ${index + 1}위에 배치했습니다.`);
        clearCandidate();
        renderBoard();
        updateRemainingList();
      }

      function handleDynamicInsertion(tier, index) {
        if (!currentCandidate) {
          showStatus("먼저 선수를 뽑아 주세요.");
          return;
        }
        if (currentCandidate.position !== currentPosition) {
          setCurrentPosition(currentCandidate.position);
          showStatus("제안된 선수의 포지션 보드로 이동했습니다. 다시 시도하세요.");
          return;
        }

        removePlayerFromState(currentCandidate.position, currentCandidate.name);
        state[currentPosition][tier.key].splice(index, 0, currentCandidate.name);
        saveState();
        const ordered = tier.ordered !== false;
        const message = ordered
          ? `${currentCandidate.name} 선수를 ${tier.label} 티어 ${index + 1}번째 자리에 배치했습니다.`
          : `${currentCandidate.name} 선수를 ${tier.label} 티어에 배치했습니다.`;
        showStatus(message);
        clearCandidate();
        renderBoard();
        updateRemainingList();
      }

      function removePlayerFromState(position, player) {
        const tiers = state[position];
        TIERS.forEach((tier) => {
          if (tier.limit) {
            tiers[tier.key] = tiers[tier.key].map((name) => (name === player ? null : name));
          } else {
            tiers[tier.key] = tiers[tier.key].filter((name) => name !== player);
          }
        });
      }

      function pickRandomPlayer() {
        const availablePositions = POSITIONS.filter(({ key }) => getAvailablePlayers(key).length > 0);
        if (!availablePositions.length) {
          showStatus("모든 선수를 이미 배치했습니다! 필요하다면 초기화하세요.");
          clearCandidate();
          return;
        }
        const position = availablePositions[Math.floor(Math.random() * availablePositions.length)];
        const remainingPlayers = getAvailablePlayers(position.key);
        const player = remainingPlayers[Math.floor(Math.random() * remainingPlayers.length)];
        currentCandidate = { name: player, position: position.key };
        setCurrentPosition(position.key);
        updateCandidateDisplay();
        showStatus(`${position.key} 포지션에서 ${player} 선수를 추천합니다.`);
      }

      function getAvailablePlayers(position) {
        const assigned = new Set();
        TIERS.forEach((tier) => {
          const players = state[position][tier.key];
          if (tier.limit) {
            players.forEach((player) => {
              if (player) assigned.add(player);
            });
          } else {
            players.forEach((player) => assigned.add(player));
          }
        });
        return PLAYERS_BY_POSITION[position].filter((player) => !assigned.has(player));
      }

      function updateCandidateDisplay() {
        if (currentCandidate) {
          dom.currentPlayerName.textContent = currentCandidate.name;
          dom.currentPlayerMeta.textContent = `${currentCandidate.position} 포지션 티어 보드에서 원하는 티어와 순위를 선택하세요.`;
        } else {
          dom.currentPlayerName.textContent = "선수를 뽑아 주세요";
          dom.currentPlayerMeta.textContent = "포지션과 티어를 선택해 배치할 선수를 뽑아 보세요.";
        }
      }

      function clearCandidate() {
        currentCandidate = null;
        updateCandidateDisplay();
      }

      function updateCurrentPositionLabel() {
        dom.currentPosition.textContent = currentPosition;
      }

      function updateRemainingList() {
        const players = getAvailablePlayers(currentPosition);
        dom.remaining.innerHTML = "";
        if (!players.length) {
          const li = document.createElement("li");
          li.textContent = "남은 선수가 없습니다.";
          dom.remaining.appendChild(li);
          return;
        }
        players.forEach((player) => {
          const li = document.createElement("li");
          li.textContent = player;
          dom.remaining.appendChild(li);
        });
      }

      function showStatus(message) {
        if (statusTimeout) {
          clearTimeout(statusTimeout);
          statusTimeout = null;
        }
        dom.status.innerHTML = `<strong>${message}</strong>`;
        statusTimeout = setTimeout(() => {
          dom.status.textContent = "";
        }, 5000);
      }

      function resetState() {
        if (!confirm("모든 티어 배치를 초기화하시겠습니까?")) {
          return;
        }
        state = createEmptyState();
        saveState();
        clearCandidate();
        renderBoard();
        updateRemainingList();
        showStatus("티어 리스트를 초기화했습니다.");
      }

      dom.randomButton.addEventListener("click", pickRandomPlayer);
      dom.resetButton.addEventListener("click", resetState);

      renderPositionTabs();
      setCurrentPosition(currentPosition);
      updateCandidateDisplay();
      updateRemainingList();
    </script>
  </body>
</html>
